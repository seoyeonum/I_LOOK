<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.team1.mybatis.IChildDAO">

    <insert id="add">
        INSERT INTO CHILD_REG (
            CHILD_REG_ID, CHILD_BACKUP_ID, NAME, HEIGHT, WEIGHT,
            SSN_FIRST, SSN_SECOND, SPECIAL_NOTES, BLOOD_TYPE
        )
        VALUES (
            #{child_reg_id}, #{child_backup_id}, #{name}, #{height}, #{weight},
            #{ssn_first}, #{ssn_second}, #{special_notes}, #{blood_type}
        )
    </insert>

    <insert id="addChildBackup">
        INSERT INTO CHILD_BACKUP (
            CHILD_BACKUP_ID, PAR_BACKUP_ID, REG_DATE
        ) VALUES (
            #{child_backup_id}, #{par_backup_id}, SYSDATE
        )
    </insert>

    <select id="findParBackupId" parameterType="string" resultType="string">
        SELECT PAR_BACKUP_ID
        FROM PAR_BACKUP
        WHERE ID = #{id}
    </select>

    <insert id="addDisease">
        INSERT INTO CHILD_MEDICALS (
            CHILD_MEDICAL_ID, MEDICAL_TYPE_ID, REG_DATE, CHILD_REG_ID
        ) VALUES (
            #{child_medical_id}, #{medical_type_id}, SYSDATE,
            (SELECT CHILD_REG_ID FROM CHILD_REG WHERE CHILD_BACKUP_ID = #{child_backup_id})
        )
    </insert>

    <insert id="addAllergy">
        INSERT INTO CHILD_ALLERGIES (
            CHILD_ALLERGY_ID, ALLERGIE_TYPE_ID, REG_DATE, CHILD_REG_ID
        ) VALUES (
            #{child_allergy_id}, #{allergy_type_id}, SYSDATE,
            (SELECT CHILD_REG_ID FROM CHILD_REG WHERE CHILD_BACKUP_ID = #{child_backup_id})
        )
    </insert>

    <insert id="addDisability">
        INSERT INTO CHILD_DISABILITIES (
            CHILD_DISABILITY_ID, DISABILITY_TYPE_ID, REG_DATE, CHILD_REG_ID
        ) VALUES (
            #{child_disability_id}, #{disability_type_id}, SYSDATE,
            (SELECT CHILD_REG_ID FROM CHILD_REG WHERE CHILD_BACKUP_ID = #{child_backup_id})
        )
    </insert>

    <select id="getDisabilityTypes" resultType="com.team1.dto.ChildDTO">
        SELECT DISABILITY_TYPE_ID, TYPE FROM DISABILITY_TYPES
    </select>

    <select id="getAllergyTypes" resultType="com.team1.dto.ChildDTO">
        SELECT ALLERGIE_TYPE_ID AS allergy_type_id, TYPE FROM ALLERGIE_TYPES
    </select>

    <select id="getMedicalTypes" resultType="com.team1.dto.ChildDTO">
        SELECT MEDICAL_TYPE_ID AS medical_type_id, TYPE FROM MEDICAL_TYPES
    </select>

</mapper>
